{% extends "base.html" %}

{% block title %} Homepage {% endblock %}

{% block content %}
{% if request.user.is_authenticated %}
<h2>Welcome {{ user.username }}</h2>


<div class="col-sm-12 col-md-offset-2 col-md-8 col-lg-offset-3 col-lg-6">
  <div class="panel panel-info">
    <table class="table tabled-condensed table-hover">
      <tr>
	<td style="text-align:center" colspan=2>
	  <div class="thumbnails">
	    <img src="{{ avatar }}"/>
	  </div>
	</td>
      </tr>
      <tr><th>Username</th><td>{{ user.username }}</td></tr>
      <tr><th>First Name</th><td>{{ user.first_name }}</td></tr>
      <tr><th>Last Name</th><td>{{ user.last_name }}</td></tr>
      <tr><th>Email</th><td>{{ user.email }}</td></tr>
      <tr><th>Codeforces Handle</th><td>{% if cfuser %} {{ cfuser.handle }} {% endif %} </td></tr>
    </table>
    <a href="{% url 'account_update' user.pk %}" type="button" class="btn btn-success">
      Edit
    </a>
    <a href="{% url 'avatar_update' user.profile.pk %}" type="button" class="btn btn-success">
      Change Picture
    </a>
    <a href="{% url 'password_change' %}" type="button" class="btn btn-success">
      Change Password
    </a>
    <a href="{% url 'codeforces_update' user.profile.pk %}" type="button" class="btn btn-warning">
      Change codeforces Handle
    </a>
    {% if cfuser %}
    <a href="{% url 'recommendation' user.pk %}" type="button" class="btn btn-info">
      {% if problems %}Renew{% else %}Get{% endif %} recommendation
    </a>
    {% endif %}
    <p/>
    {% if problems %}
    <h3>Recommendation for {{ cfuser.handle }}</h3>

    We recommend to try and solve these problems

    <div class="panel panel-info">
      <table class="table tabled-condensed table-hover">
	<tr><td>Name</td><td>Tags</td></tr>
	{% for pb, pburl, tags in problems %}
	<tr><td> <a href="{{ pburl }}">{{ pb }}</a></td><td><ul>{% for tag in tags %}<li>{{ tag.name }}</li>{% endfor %}</ul></td></tr>
	{% endfor %}
      </table>
    </div>
    {% endif %}
  </div>
</div>

{% else %}
<h2>Welcome to {{ sitename }} !!</h2>
{% endif %}

{% endblock %}
